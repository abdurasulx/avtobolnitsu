{% extends 'patients/base.html' %}
{% load static %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å –ø–∞—Ü–∏–µ–Ω—Ç–∞{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-md-7">

    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}

    <!-- ü©∫ Bemor ma'lumotlari -->
    <div class="card mb-4">
      <div class="card-header bg-primary text-white">
        <h5 class="mb-0">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h5>
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label class="form-label text-muted small">–§–ò–û</label>
          <input class="form-control-plaintext" value="{{ patient.user.get_full_name }}" readonly>
        </div>
        <div class="mb-3">
          <label class="form-label text-muted small">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞</label>
          <input class="form-control-plaintext" value="{{ patient.user.email|default:'–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}" readonly>
        </div>
        <div class="mb-3">
          <label class="form-label text-muted small">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
          <input class="form-control-plaintext" value="{{ patient.user.username }}" readonly>
        </div>

        {% if patient.phone %}
        <div class="mb-3">
          <label class="form-label text-muted small">–¢–µ–ª–µ—Ñ–æ–Ω</label>
          <input class="form-control-plaintext" value="{{ patient.phone }}" readonly>
        </div>
        {% endif %}

        <!-- üîë Ochiq parol ko'rsatish (test uchun ‚Äì production da olib tashlang!) -->
        
      </div>
    </div>

    <!-- üîí Parolni yangilash -->
    <div class="card">
      <div class="card-header bg-light">
        <h6 class="mb-0">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h6>
      </div>
      <div class="card-body">
        <form method="post" novalidate>
          {% csrf_token %}
          <div class="mb-3">
            {{ form.new_password1.label_tag }}
             <!-- Bootstrap sinfi -->
              <input type="password" name="{{ form.new_password1.name }}" class="form-control" id="{{ form.new_password1.id_for_label }}">
            {% if form.new_password1.errors %}
              <div class="text-danger small">{{ form.new_password1.errors }}</div>
            {% endif %}
          </div>

          <div class="mb-3">
            {{ form.new_password2.label_tag }}
              <!-- Bootstrap sinfi -->
              <input type="password" name="{{ form.new_password2.name }}" class="form-control" id="{{ form.new_password2.id_for_label }}">
            {% if form.new_password2.errors %}
              <div class="text-danger small">{{ form.new_password2.errors }}</div>
            {% endif %}
          </div>

          <button type="submit" class="btn btn-primary w-100">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
        </form>
      </div>
    </div>

  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  // Qo'shimcha: forma inputlariga bootstrap sinf beramiz (avtomatik)
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('input[type=password]').forEach(inp => {
      inp.classList.add('form-control');
    });
  });
</script>
{% endblock %}